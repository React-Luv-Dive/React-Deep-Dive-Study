## 사용자 정의 훅
- 함수 내부에서 react 훅을 호출하고 있는 함수.
- 사용자 정의 훅은 `use-*`로 시작해야 한다.

## 고차 컴포넌트
- 리액트 훅을 기반으로 한 컴포넌트 자체의 로직을 재사용하기 위한 방법.
- 고차 함수의 원리를 적용했다.

---
사용자 정의 훅과 고차 컴포넌트의 차이를 가장 잘 확인할 수 있는 게 React.memo이다.

### React.memo
- 리액트는 자식 컴포넌트의 props엔 변경이 없더라도 부모에서 리렌더링이 일어나면 리렌더링 됨.
- 렌더링하기 앞서 props에 변경사항이 있는지 비교하고 없다면 이전에 기억해 둔 컴포넌트를 실행하는 것이 React.memo

```tsx
const ChildComponent = memo(({value}: {value: string}) => {
	useEffect(() => {
		console.log('렌더링!');
	})

	return <>안녕하세용</>
})

function ParentComponent() {
	const [state, setState] = useState(1);

	function handleChange(e: ChangeEvent<HTMLInputElement>) {
		setState(Number(e.target.value))
	}

	<>
		<input type='number' value={state} onChange={handleChange} />
		<ChildComponent value='hello' />
	</>
}
```


### useMemo
이런 방식으로 사용할 수는 있지만 혼란을 빚을 수 있으므로 컴포넌트 자체를 Memoization할 땐 React.memo를 사용하는 것이 좋다.
```tsx
function ParentComponent() {
	const [state, setState] = useState(1);

	function handleChange(e: ChangeEvent<HTMLInputElement>) {
		setState(Number(e.target.value))
	}

	const MemoizedChildComponent = useMemo(() => {
		return <ChildComponent value='hello' />
	}, [])

	<>
		<input type='number' value={state} onChange={handleChange} />
		{MemoizedChildComponent}
	</>
}
```


---


### 고차 함수를 활용한 리액트 고차 컴포넌트 만들기
#### 고차 함수
> 함수를 인수로 받거나 결과로 반환하는 함수
> e.g. Array.prototype.map


#### 로그인 고차 컴포넌트 만들기

상황: 사용자 인증 정보에 따라 인증된 사용자에게는 개인화된 컴포넌트를, 그렇지 않은 사용자에게는 별도로 정의된 공통 컴포넌트를 보여준다.

```tsx
interface LoginProps {
	loginRequired?: boolean
}

function withLoginComponent<T>(Component: ComponentType<T>) {
	// 타이핑을 이렇게도 할 수 있구나.
	return function (props: T & LoginProps) {
		const {loginRequired, ...restProps} = props

		// loginRequired가 없거나 false라면 원래 컴포넌트를 그대로 반환
		if(loginRequired) {
			return <>로그인이 필요합니다.</>
		}
		return <Component {...(restProps as T)} />
	}
}

const MyPage = withLoginComponent((props): {name: string}) => {
	return <h3>{props.name}</h3>
})

export default function App() {
	const isLogin = true;
	return <MyPage name="김다은" loginRequired={isLogin} />
}
```

단순히 값을 반환하거나 부수 효과를 실행하는 사용자 정의 훅과는 다르게, 고차 컴포넌트는 컴포넌트의 결과물에 영향을 미칠 수 있는 다른 공통 작업을 처리할 수 있다.


#### 고차 컴포넌트 사용 시 주의해야 할 점
- 고차 컴포넌트는 with로 시작하는 이름을 사용해야 한다.
- 전달된 컴포넌트의 props를 임의로 수정, 추가, 삭제하는 일이 없어야 한다.(당연)
- 여러 개의 고차 컴포넌트로 컴포넌트를 감쌀 경우 복잡성이 커진다. 고차 컴포넌트가 증가할수록 개발자는 이것이 어떤 결과를 만들어 낼지 예측하기 어려워진다.

---

### 사용자 정의 훅과 고차 컴포넌트 중 무엇을 써야 하나?
- 사용자 정의 훅이 필요한 경우
	- 단순히 컴포넌트 전반에 걸쳐 동일한 로직으로 값을 제공하거나 특정한 작동을 하게 하고 싶을 때.
- 고차 컴포넌트를 사용해야 하는 경우
	- 애플리케이션 관점에서 세부 로직을 감추고 공통 컴포넌트를 노출하고 싶을 때
	- 렌더링의 결과물에도 영향을 미치는 공통 로직이 있을 때
