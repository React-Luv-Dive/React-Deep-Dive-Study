# useState

## 기본값

useState에서 기본값엔 두 가지가 들어갈 수 있다.

- 원시값
- 특정한 값을 반환하는 함수

이 중 변수 대신 함수를 넘기는 것을 **게으른 초기화**라고 한다.
게으른 초기화는 오로지 state가 처음 만들어질 때만 사용된다. 만약 이후에 **리렌더링이 발생한다고 해도 이 함수의 실행은 무시된다**.

이러한 게으른 초기화는 useState의 초기값이 복잡하거나 무거운 연산을 포함하고 있을 때 사용한다.
무거운 연산의 기준은 다음과 같다.

- localStorage나 sessionStorage에 대한 접근이 필요할 때
- map, filter, find와 같이 배열에 접근을 해야할 때
- 초깃값 계산을 위해 함수 호출이 필요할 때

#### 코드 개선하기

createObjectWithKeys는 initialValues의 키 배열과 초기값을 받아 reduce 함수를 사용해 새로운 객체를 만들어 반환한다.
이는 `map, filter, find와 같이 배열에 접근을 해야할 때`에 해당된다고 볼 수 있다.

```tsx
const [isError, setIsError] = useState(
  createObjectWithKeys(Object.keys(initialValues), false)
);

export function createObjectWithKeys<T>(
  keys: string[],
  initialValue: T
): Record<string, T> {
  return keys.reduce<Record<string, T>>((acc, key) => {
    acc[key] = initialValue;
    return acc;
  }, {});
}
```

따라서 게으른 초기화를 적용해 다음과 같이 개선할 수 있다.

```tsx
const [isError, setIsError] = useState(() =>
  createObjectWithKeys(Object.keys(initialValues), false)
);
```
